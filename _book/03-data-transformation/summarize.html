<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.20">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>12&nbsp; Beobachtungen zusammenfassen – Hands-On Exploratory Data Analytics</title>
<style>
/* Default styles provided by pandoc.
** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
*/
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../03-data-transformation/joining-data.html" rel="next">
<link href="../03-data-transformation/filter.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-3512cbed9e2527d986e9b0b56d261405.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-2aba14264cc3e83a53bc9b44aa83aa68.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script><link rel="stylesheet" href="../styles/sidebar.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-data-transformation/loading-data.html">Datentransformation</a></li><li class="breadcrumb-item"><a href="../03-data-transformation/summarize.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Beobachtungen zusammenfassen</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Hands-On Exploratory Data Analytics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Hintergründe</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-background/empirical-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Empirische Forschung</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Erste Schritte mit R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-r-basics/ide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Entwicklungsumgebung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-r-basics/programming-with-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programmieren mit R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-r-basics/data-representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Datenrepräsentation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Datentransformation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/loading-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Daten laden</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/pipe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pipe-Operator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/exploring-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Daten kennenlernen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/select.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Variablen auswählen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/mutate-modify.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variablen verändern</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/mutate-add.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Variablen erstellen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Beobachtungen auswählen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/summarize.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Beobachtungen zusammenfassen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-data-transformation/joining-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Datensätze verbinden</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Datenvisualisierung</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/grammar-of-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Grammar of Graphics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/bar-charts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Balkendiagramme</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/scatter-plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Punktediagramme</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/histograms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Histogramme</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/boxplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Boxplots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/line-charts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Liniendiagramme</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-data-visualization/visualizations-polish.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Visualisuerungen polieren</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Projekt 1: Umfragen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-1-survey/survey-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Umfragedaten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-1-survey/types-of-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Arten von Variablen</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Projekt 2: News</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-2-news/load.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Laden der Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-2-news/factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Faktoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-2-news/variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Übersicht der Variablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project-2-news/time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Zeit</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/appendix-a-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anhang A: Scraping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/appendix-b-supplemental.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anhang A: Material</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quellen</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li>
<a href="#sec-summarize-grundprinzip" id="toc-sec-summarize-grundprinzip" class="nav-link active" data-scroll-target="#sec-summarize-grundprinzip"><span class="header-section-number">12.1</span> Das Grundprinzip</a>
  <ul class="collapse">
<li><a href="#h%C3%A4ufige-zusammenfassungsfunktionen" id="toc-häufige-zusammenfassungsfunktionen" class="nav-link" data-scroll-target="#h%C3%A4ufige-zusammenfassungsfunktionen">Häufige Zusammenfassungsfunktionen</a></li>
  </ul>
</li>
  <li><a href="#sec-summarize-vs-mutate" id="toc-sec-summarize-vs-mutate" class="nav-link" data-scroll-target="#sec-summarize-vs-mutate"><span class="header-section-number">12.2</span> <code>summarise()</code> und <code>mutate()</code> im Vergleich</a></li>
  <li>
<a href="#sec-summarize-groupby" id="toc-sec-summarize-groupby" class="nav-link" data-scroll-target="#sec-summarize-groupby"><span class="header-section-number">12.3</span> Gruppieren mit <code>group_by()</code></a>
  <ul class="collapse">
<li><a href="#mehrere-gruppierungsvariablen" id="toc-mehrere-gruppierungsvariablen" class="nav-link" data-scroll-target="#mehrere-gruppierungsvariablen">Mehrere Gruppierungsvariablen</a></li>
  <li><a href="#gruppierung-und-der-unterschied-zu-mutate" id="toc-gruppierung-und-der-unterschied-zu-mutate" class="nav-link" data-scroll-target="#gruppierung-und-der-unterschied-zu-mutate">Gruppierung und der Unterschied zu <code>mutate()</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-summarize-shortcuts" id="toc-sec-summarize-shortcuts" class="nav-link" data-scroll-target="#sec-summarize-shortcuts"><span class="header-section-number">12.4</span> Abkürzungen</a>
  <ul class="collapse">
<li><a href="#count" id="toc-count" class="nav-link" data-scroll-target="#count"><code>count()</code></a></li>
  <li><a href="#tally" id="toc-tally" class="nav-link" data-scroll-target="#tally"><code>tally()</code></a></li>
  <li><a href="#add_count" id="toc-add_count" class="nav-link" data-scroll-target="#add_count"><code>add_count()</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-summarize-across" id="toc-sec-summarize-across" class="nav-link" data-scroll-target="#sec-summarize-across"><span class="header-section-number">12.5</span> Mehrere Spalten mit <code>across()</code></a>
  <ul class="collapse">
<li><a href="#mehrere-funktionen-gleichzeitig" id="toc-mehrere-funktionen-gleichzeitig" class="nav-link" data-scroll-target="#mehrere-funktionen-gleichzeitig">Mehrere Funktionen gleichzeitig</a></li>
  <li><a href="#across-mit-gruppierung" id="toc-across-mit-gruppierung" class="nav-link" data-scroll-target="#across-mit-gruppierung"><code>across()</code> mit Gruppierung</a></li>
  </ul>
</li>
  <li><a href="#sec-summarize-pipe" id="toc-sec-summarize-pipe" class="nav-link" data-scroll-target="#sec-summarize-pipe"><span class="header-section-number">12.6</span> Zusammenfassungen in der Pipe</a></li>
  <li><a href="#sec-summarize-zusammenfassung" id="toc-sec-summarize-zusammenfassung" class="nav-link" data-scroll-target="#sec-summarize-zusammenfassung"><span class="header-section-number">12.7</span> Kurz zusammengefasst</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-data-transformation/loading-data.html">Datentransformation</a></li><li class="breadcrumb-item"><a href="../03-data-transformation/summarize.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Beobachtungen zusammenfassen</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-summarize" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Beobachtungen zusammenfassen</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Bisher habt ihr gelernt, in welcher Form man Spalten und Zeilen bearbeitet, ohne jedoch die grundsätzliche Struktur des Datensatzes massiv zu verändern. In diesem Kapitel geht es nun um das Verdichten von Daten. Mit der Funktion <code>summarise()</code> aus dem <code>dplyr</code>-Paket könnt ihr aus hunderten Einzelwerten eine Handvoll aussagekräftiger Kennzahlen berechnen, wie Mittelwerte, Summen oder Anzahlen. Meistens geschieht dies nicht für den gesamten Datensatz, sondern für definierte Untergruppen, wofür wir die Funktion <code>group_by()</code> nutzen.</p>
<p>Das Aggregieren von Daten ist ein Schlüsselelement der deskriptiven Statistik und Berichtserstellung. Selten interessiert sich jemand für jede einzelne Transaktion in einem Datensatz. Die wahren Erkenntnisse – und auch die Grundlage für aussagekräftige Visualisierungen – liegen stattdessen in den zusammengefassten Kennzahlen: Welches Produkt hat den höchsten Durchschnittsumsatz? Wie viele Nutzer waren pro Wochentag aktiv? <code>summarise()</code> liefert euch genau diese aggregierten Werte prägnant und effizient.</p>
<p>Die folgende Tabelle zeigt die Funktionen, die wir in diesem Abschnitt kennenlernen.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Funktion</th>
<th>Beschreibung</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>summarise()</code></td>
<td>Datensatz auf Kennzahlen verdichten</td>
</tr>
<tr class="even">
<td>
<code>group_by()</code> / <code>ungroup()</code>
</td>
<td>Datensatz gruppieren bzw. Gruppierung aufheben</td>
</tr>
<tr class="odd">
<td>
<code>n()</code> / <code>n_distinct()</code>
</td>
<td>Zeilen bzw. eindeutige Werte zählen</td>
</tr>
<tr class="even">
<td>
<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> / <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> / <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>
</td>
<td>Mittelwert, Median, Summe</td>
</tr>
<tr class="odd">
<td>
<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code> / <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> / <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>
</td>
<td>Minimum, Maximum, Standardabweichung</td>
</tr>
<tr class="even">
<td>
<code>count()</code> / <code>tally()</code> / <code>add_count()</code>
</td>
<td>Abkürzungen zum Zählen</td>
</tr>
<tr class="odd">
<td><code>across()</code></td>
<td>Zusammenfassungen auf mehrere Spalten anwenden</td>
</tr>
</tbody>
</table>
<p>Sehen wir uns zunächst an, wie wir den kompletten Datensatz auf eine einzige Zeile zusammenfassen können.</p>
<section id="sec-summarize-grundprinzip" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="sec-summarize-grundprinzip">
<span class="header-section-number">12.1</span> Das Grundprinzip</h2>
<p><code>summarise()</code> nimmt einen Tibble und gibt einen neuen Tibble mit einer einzigen Zeile zurück. In dieser Zeile stehen die Ergebnisse eurer Zusammenfassungsfunktionen.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    total_tweets <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    avg_retweets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    max_likes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">favorite_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  total_tweets avg_retweets max_likes
         &lt;int&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1        58421         140.    105493</code></pre>
</div>
</div>
<p>Drei Dinge fallen auf:</p>
<ul>
<li>
<code>n()</code> zählt die Zeilen. Es braucht kein Argument.</li>
<li>
<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> und <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code> berechnen den Durchschnitt und das Maximum. Das Argument <code>na.rm = TRUE</code> sorgt dafür, dass fehlende Werte ignoriert werden.</li>
<li>Das Ergebnis ist ein Tibble mit einer Zeile und drei Spalten. Der ursprüngliche Datensatz mit seinen vielen Spalten und Zeilen ist verschwunden.</li>
</ul>
<p><em>Abbildung: Links ein großer Datensatz als Tabelle mit vielen Zeilen und Spalten. In der Mitte ein Trichtersymbol mit der Beschriftung <code>summarise()</code>. Rechts ein kleiner Tibble mit einer einzigen Zeile und drei Spalten (total_tweets, avg_retweets, max_likes). Der Fokus liegt darauf, dass viele Zeilen zu einer einzigen Zeile komprimiert werden.</em></p>
<section id="häufige-zusammenfassungsfunktionen" class="level3"><h3 class="anchored" data-anchor-id="häufige-zusammenfassungsfunktionen">Häufige Zusammenfassungsfunktionen</h3>
<p>Hier sind die Funktionen, die ihr am häufigsten in <code>summarise()</code> verwenden werdet:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Funktion</th>
<th>Beschreibung</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>n()</code></td>
<td>Anzahl der Zeilen</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code></td>
<td>Summe</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code></td>
<td>Arithmetisches Mittel</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/median.html">median()</a></code></td>
<td>Median</td>
</tr>
<tr class="odd">
<td>
<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code> / <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>
</td>
<td>Minimum / Maximum</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code></td>
<td>Standardabweichung</td>
</tr>
<tr class="odd">
<td>
<code>first()</code> / <code>last()</code>
</td>
<td>Erster / letzter Wert</td>
</tr>
<tr class="even">
<td><code>n_distinct()</code></td>
<td>Anzahl eindeutiger Werte</td>
</tr>
</tbody>
</table>
<p>Die meisten dieser Funktionen brauchen <code>na.rm = TRUE</code>, wenn eure Daten fehlende Werte enthalten. Ohne dieses Argument gibt R bei einem einzigen <code>NA</code> als Ergebnis <code>NA</code> zurück.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="na.rm nicht vergessen">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>na.rm nicht vergessen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> oder eine andere Aggregatfunktion plötzlich <code>NA</code> zurückgibt, obwohl ihr echte Daten habt, liegt es fast immer an fehlenden Werten. Fügt <code>na.rm = TRUE</code> hinzu, und das Problem ist gelöst.</p>
</div>
</div>
</section></section><section id="sec-summarize-vs-mutate" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="sec-summarize-vs-mutate">
<span class="header-section-number">12.2</span> <code>summarise()</code> und <code>mutate()</code> im Vergleich</h2>
<p>Was ist eigentlich der Unterschied zwischen <code>summarise()</code> und <code>mutate()</code>? Beide können mit Aggregatfunktionen wie <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> arbeiten, aber sie tun etwas grundlegend Verschiedenes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>avg_retweets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">screen_name</span>, <span class="va">retweet_count</span>, <span class="va">avg_retweets</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  screen_name retweet_count avg_retweets
  &lt;chr&gt;               &lt;dbl&gt;        &lt;dbl&gt;
1 lisapaus                1         59.0
2 lisapaus                1         59.0
3 Wissing                 6         59.0
4 Wissing                 9         59.0
5 Wissing                15         59.0</code></pre>
</div>
</div>
<p><code>mutate()</code> berechnet den Durchschnitt und schreibt ihn in jede Zeile. Der Datensatz bleibt gleich lang. Das ist nützlich, wenn ihr den Durchschnitt als Referenzwert neben jedem einzelnen Tweet sehen wollt.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_retweets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avg_retweets
         &lt;dbl&gt;
1         59.0</code></pre>
</div>
</div>
<p><code>summarise()</code> dagegen komprimiert alles auf eine Zeile. Der Datensatz wird kürzer. Das ist nützlich, wenn euch nur die Kennzahl selbst interessiert.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header">
<th></th>
<th><code>mutate()</code></th>
<th><code>summarise()</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Ergebnis</td>
<td>Gleich viele Zeilen wie vorher</td>
<td>Eine Zeile (oder eine pro Gruppe)</td>
</tr>
<tr class="even">
<td>Zweck</td>
<td>Wert als neue Spalte neben die bestehenden Daten schreiben</td>
<td>Daten auf Kennzahlen verdichten</td>
</tr>
</tbody>
</table></section><section id="sec-summarize-groupby" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="sec-summarize-groupby">
<span class="header-section-number">12.3</span> Gruppieren mit <code>group_by()</code>
</h2>
<div id="fig-r-basics-summarize-groupby-shema" class="lightbox quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-r-basics-summarize-groupby-shema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://winf-hsos.github.io/university-docs/images/group_by_summarize_schema.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;12.1: In Kombination mit Gruppierung erzeugt summarize mehrere Zeilen statt nur eine."><img src="https://winf-hsos.github.io/university-docs/images/group_by_summarize_schema.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-basics-summarize-groupby-shema-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;12.1: In Kombination mit Gruppierung erzeugt <code>summarize</code> mehrere Zeilen statt nur eine.
</figcaption></figure>
</div>
<p>Die eigentliche Stärke von <code>summarise()</code> zeigt sich erst in Kombination mit <code>group_by()</code>. Ohne Gruppierung bekommt ihr eine einzige Zeile. Mit Gruppierung bekommt ihr eine Zeile pro Gruppe.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    tweet_count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    avg_retweets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_likes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">favorite_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">avg_retweets</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   screen_name     tweet_count avg_retweets avg_likes
   &lt;chr&gt;                 &lt;int&gt;        &lt;dbl&gt;     &lt;dbl&gt;
 1 Karl_Lauterbach        4018        295.      3020.
 2 ABaerbock               367        287.      2791.
 3 Bundeskanzler           715        225.      1919.
 4 ABaerbockArchiv        1233         99.3     1169.
 5 cem_oezdemir           1876         57.7      694.
 6 c_lindner              2931         38.9      518.
 7 NancyFaeser            1505         34.7      401.
 8 OlafScholz             1958         33.8      337.
 9 hubertus_heil          1361         19.8      196.
10 MarcoBuschmann         4436         14.0      174.</code></pre>
</div>
</div>
<p>Was passiert hier?</p>
<ol type="1">
<li>
<code>group_by(screen_name)</code> teilt den Datensatz in Gruppen auf, eine pro Account.</li>
<li>
<code>summarise()</code> berechnet die Kennzahlen innerhalb jeder Gruppe.</li>
<li>Das Ergebnis hat eine Zeile pro Account statt einer Zeile pro Tweet.</li>
</ol>
<p><em>Abbildung: Links ein Datensatz mit vielen Zeilen, die farblich nach drei Gruppen markiert sind (zum Beispiel rot, blau, grün). In der Mitte steht <code>group_by() |&gt; summarise()</code>. Rechts ein kleiner Tibble mit drei Zeilen, eine pro Gruppe, mit den Spalten “group”, “count” und “avg_value”. Jede Zeile hat die Farbe ihrer Gruppe. Der Fokus liegt darauf, dass die Zusammenfassung pro Gruppe statt über den gesamten Datensatz erfolgt.</em></p>
<section id="mehrere-gruppierungsvariablen" class="level3"><h3 class="anchored" data-anchor-id="mehrere-gruppierungsvariablen">Mehrere Gruppierungsvariablen</h3>
<p>Ihr könnt auch nach mehreren Variablen gleichzeitig gruppieren. Dann bekommt ihr eine Zeile pro Kombination:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span>, <span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    avg_likes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">favorite_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   screen_name     is_retweet count avg_likes
   &lt;chr&gt;           &lt;lgl&gt;      &lt;int&gt;     &lt;dbl&gt;
 1 ABaerbock       FALSE        367     2791.
 2 ABaerbock       TRUE          10        0 
 3 ABaerbockArchiv FALSE       1233     1169.
 4 ABaerbockArchiv TRUE        1958        0 
 5 Bundeskanzler   FALSE        715     1919.
 6 Bundeskanzler   TRUE          18        0 
 7 Karl_Lauterbach FALSE       4018     3020.
 8 Karl_Lauterbach TRUE         121        0 
 9 MarcoBuschmann  FALSE       4436      174.
10 MarcoBuschmann  TRUE         735        0 </code></pre>
</div>
</div>
<p><code>.groups = "drop"</code> entfernt die Gruppierung nach dem Zusammenfassen. Ohne diesen Parameter bleibt eine Restgruppierung bestehen, was zu unerwartetem Verhalten bei nachfolgenden Operationen führen kann.</p>
<div class="callout callout-style-default callout-tip callout-titled" title=".groups kontrollieren">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>.groups kontrollieren
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn ihr <code>.groups</code> nicht angebt, zeigt <code>dplyr</code> eine Meldung an, welche Gruppierung übrig bleibt. Die sicherste Option ist <code>.groups = "drop"</code>, damit die Gruppierung danach aufgehoben ist. Alternativ könnt ihr <code>ungroup()</code> nach <code>summarise()</code> aufrufen.</p>
</div>
</div>
</section><section id="gruppierung-und-der-unterschied-zu-mutate" class="level3"><h3 class="anchored" data-anchor-id="gruppierung-und-der-unterschied-zu-mutate">Gruppierung und der Unterschied zu <code>mutate()</code>
</h3>
<p>Im Kapitel über <code>mutate()</code> habt ihr gesehen, dass <code>group_by() |&gt; mutate()</code> den Datensatz gleich lang lässt und die Kennzahl in jede Zeile schreibt. <code>group_by() |&gt; summarise()</code> dagegen komprimiert den Datensatz auf eine Zeile pro Gruppe.</p>
<p>Hier nochmal der Unterschied im direkten Vergleich:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># mutate: gleich viele Zeilen, Gruppenwert in jeder Zeile</span></span>
<span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group_avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">screen_name</span>, <span class="va">retweet_count</span>, <span class="va">group_avg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  screen_name retweet_count group_avg
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;
1 lisapaus                1      5.56
2 lisapaus                1      5.56
3 Wissing                 6     12.5 
4 Wissing                 9     12.5 
5 Wissing                15     12.5 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># summarise: eine Zeile pro Gruppe</span></span>
<span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>group_avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  screen_name     group_avg
  &lt;chr&gt;               &lt;dbl&gt;
1 ABaerbock           287. 
2 ABaerbockArchiv      99.3
3 Bundeskanzler       225. 
4 Karl_Lauterbach     295. 
5 MarcoBuschmann       14.0</code></pre>
</div>
</div>
<p>Welche Variante ihr braucht, hängt von eurer Frage ab: Wollt ihr die Kennzahl neben den Originaldaten sehen (→ <code>mutate()</code>), oder braucht ihr eine kompakte Übersicht (→ <code>summarise()</code>)?</p>
</section></section><section id="sec-summarize-shortcuts" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="sec-summarize-shortcuts">
<span class="header-section-number">12.4</span> Abkürzungen</h2>
<p>Für die häufigsten Zusammenfassungen gibt es in <code>dplyr</code> kürzere Schreibweisen, die euren Code kompakter und lesbarer machen.</p>
<section id="count" class="level3"><h3 class="anchored" data-anchor-id="count"><code>count()</code></h3>
<p>Die mit Abstand häufigste Zusammenfassung ist das Zählen. Wie oft kommt ein bestimmter Wert vor? <code>count()</code> ist die Abkürzung dafür:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">screen_name</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   screen_name         n
   &lt;chr&gt;           &lt;int&gt;
 1 c_lindner        5172
 2 MarcoBuschmann   5171
 3 cem_oezdemir     4704
 4 lisapaus         4260
 5 Karl_Lauterbach  4139
 6 W_Schmidt_       3936
 7 SvenjaSchulze68  3856
 8 starkwatzinger   3848
 9 hubertus_heil    3751
10 SteffiLemke      3581</code></pre>
</div>
</div>
<p>Das ist gleichbedeutend mit:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   screen_name         n
   &lt;chr&gt;           &lt;int&gt;
 1 c_lindner        5172
 2 MarcoBuschmann   5171
 3 cem_oezdemir     4704
 4 lisapaus         4260
 5 Karl_Lauterbach  4139
 6 W_Schmidt_       3936
 7 SvenjaSchulze68  3856
 8 starkwatzinger   3848
 9 hubertus_heil    3751
10 SteffiLemke      3581</code></pre>
</div>
</div>
<p>Der Unterschied: <code>count()</code> spart drei Zeilen Code. Das Argument <code>sort = TRUE</code> sortiert gleich absteigend nach Häufigkeit.</p>
<p>Ihr könnt auch nach mehreren Variablen gleichzeitig zählen:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">screen_name</span>, <span class="va">is_retweet</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   screen_name     is_retweet     n
   &lt;chr&gt;           &lt;lgl&gt;      &lt;int&gt;
 1 MarcoBuschmann  FALSE       4436
 2 Karl_Lauterbach FALSE       4018
 3 starkwatzinger  FALSE       2942
 4 c_lindner       FALSE       2931
 5 cem_oezdemir    TRUE        2828
 6 Wissing         FALSE       2447
 7 hubertus_heil   TRUE        2390
 8 c_lindner       TRUE        2241
 9 lisapaus        TRUE        2162
10 klara_geywitz   FALSE       2118</code></pre>
</div>
</div>
</section><section id="tally" class="level3"><h3 class="anchored" data-anchor-id="tally"><code>tally()</code></h3>
<p><code>tally()</code> ist eine noch einfachere Variante: Es zählt die Zeilen des aktuellen (möglicherweise gruppierten) Datensatzes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tally</span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   screen_name         n
   &lt;chr&gt;           &lt;int&gt;
 1 c_lindner        5172
 2 MarcoBuschmann   5171
 3 cem_oezdemir     4704
 4 lisapaus         4260
 5 Karl_Lauterbach  4139
 6 W_Schmidt_       3936
 7 SvenjaSchulze68  3856
 8 starkwatzinger   3848
 9 hubertus_heil    3751
10 SteffiLemke      3581</code></pre>
</div>
</div>
<p>Der Unterschied zu <code>count()</code>: Bei <code>tally()</code> müsst ihr vorher selbst <code>group_by()</code> aufrufen. <code>count()</code> macht das intern für euch. In der Praxis ist <code>count()</code> daher oft die bequemere Wahl.</p>
</section><section id="add_count" class="level3"><h3 class="anchored" data-anchor-id="add_count"><code>add_count()</code></h3>
<p>Manchmal wollt ihr die Häufigkeit nicht als Zusammenfassung, sondern als zusätzliche Spalte neben den Originaldaten. Dafür gibt es <code>add_count()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_count</span><span class="op">(</span><span class="va">screen_name</span>, name <span class="op">=</span> <span class="st">"tweets_per_user"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">screen_name</span>, <span class="va">tweets_per_user</span>, <span class="va">text</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  screen_name  tweets_per_user text                                             
  &lt;chr&gt;                  &lt;int&gt; &lt;chr&gt;                                            
1 cem_oezdemir            4704 "RT @BriHasselmann: Endlich! Wir sind drangeblie…
2 W_Schmidt_              3936 "RT @aakashg0: Twitter revealed its algorithm to…
3 lisapaus                4260 "@HassoSuliak @Storch_i @tagesschau Die EU Richt…
4 lisapaus                4260 "@andiewoerle @svenlehmann Nein, sie werden nich…
5 Wissing                 3446 "\U0001f449 https://t.co/NTFHy7j9AT"             </code></pre>
</div>
</div>
<p><code>add_count()</code> verhält sich wie <code>count()</code>, aber der Datensatz behält seine ursprüngliche Länge. Es ist die Abkürzung für <code>group_by() |&gt; mutate(n = n()) |&gt; ungroup()</code>.</p>
</section></section><section id="sec-summarize-across" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="sec-summarize-across">
<span class="header-section-number">12.5</span> Mehrere Spalten mit <code>across()</code>
</h2>
<p>Wenn ihr dieselbe Zusammenfassung auf mehrere Spalten gleichzeitig anwenden wollt, spart <code>across()</code> viel Tipparbeit:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">retweet_count</span>, <span class="va">favorite_count</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  retweet_count favorite_count
          &lt;dbl&gt;          &lt;dbl&gt;
1          59.0           612.</code></pre>
</div>
</div>
<p><code>across()</code> nimmt die Spaltenauswahl und die Funktion als Argumente. Für die Spaltenauswahl könnt ihr die gleichen Helfer wie bei <code>select()</code> verwenden:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  retweet_count favorite_count quote_count reply_count
          &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1          59.0           612.           0           0</code></pre>
</div>
</div>
<section id="mehrere-funktionen-gleichzeitig" class="level3"><h3 class="anchored" data-anchor-id="mehrere-funktionen-gleichzeitig">Mehrere Funktionen gleichzeitig</h3>
<p>Wenn ihr mehr als eine Funktion auf jede Spalte anwenden wollt, übergebt eine benannte Liste:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">retweet_count</span>, <span class="va">favorite_count</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>avg <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, max <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  retweet_count_avg retweet_count_max favorite_count_avg favorite_count_max
              &lt;dbl&gt;             &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;
1              59.0             12652               612.             105493</code></pre>
</div>
</div>
<p>Die Spaltennamen im Ergebnis setzen sich automatisch zusammen: <code>retweet_count_avg</code>, <code>retweet_count_max</code>, und so weiter.</p>
</section><section id="across-mit-gruppierung" class="level3"><h3 class="anchored" data-anchor-id="across-mit-gruppierung">
<code>across()</code> mit Gruppierung</h3>
<p>Natürlich funktioniert <code>across()</code> auch mit <code>group_by()</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">retweet_count</span>, <span class="va">favorite_count</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">retweet_count</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   screen_name     retweet_count favorite_count
   &lt;chr&gt;                   &lt;dbl&gt;          &lt;dbl&gt;
 1 Karl_Lauterbach         295.           3020.
 2 ABaerbock               287.           2791.
 3 Bundeskanzler           225.           1919.
 4 ABaerbockArchiv          99.3          1169.
 5 cem_oezdemir             57.7           694.
 6 c_lindner                38.9           518.
 7 NancyFaeser              34.7           401.
 8 OlafScholz               33.8           337.
 9 hubertus_heil            19.8           196.
10 MarcoBuschmann           14.0           174.</code></pre>
</div>
</div>
</section></section><section id="sec-summarize-pipe" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="sec-summarize-pipe">
<span class="header-section-number">12.6</span> Zusammenfassungen in der Pipe</h2>
<p>In der Praxis steht <code>summarise()</code> selten allein. Es ist fast immer Teil einer Pipe-Kette, die den Datensatz vorher filtert, gruppiert und nachher sortiert oder weiterverarbeitet.</p>
<p>Hier ist ein typisches Muster, das euch im Buch immer wieder begegnen wird:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tweets</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_retweet</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">screen_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    tweets <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    avg_retweets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">retweet_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_likes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">favorite_count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tweets</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">avg_retweets</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   screen_name     tweets avg_retweets avg_likes
   &lt;chr&gt;            &lt;int&gt;        &lt;dbl&gt;     &lt;dbl&gt;
 1 Karl_Lauterbach   4018        295.      3020.
 2 ABaerbock          367        287.      2791.
 3 Bundeskanzler      715        225.      1919.
 4 ABaerbockArchiv   1233         99.3     1169.
 5 cem_oezdemir      1876         57.7      694.
 6 c_lindner         2931         38.9      518.
 7 NancyFaeser       1505         34.7      401.
 8 OlafScholz        1958         33.8      337.
 9 hubertus_heil     1361         19.8      196.
10 MarcoBuschmann    4436         14.0      174.</code></pre>
</div>
</div>
<p>Beobachtet den Aufbau:</p>
<ol type="1">
<li>
<strong>Filtern</strong>: Nur Original-Tweets, ohne fehlende Accountnamen.</li>
<li>
<strong>Gruppieren</strong>: Pro Account.</li>
<li>
<strong>Zusammenfassen</strong>: Zählen, Durchschnitte berechnen.</li>
<li>
<strong>Nochmal filtern</strong>: Nur Accounts mit mindestens 10 Tweets, damit der Durchschnitt aussagekräftig ist.</li>
<li>
<strong>Sortieren</strong>: Die aktivsten Accounts zuerst.</li>
</ol>
<p>Dieser Ablauf ist ein Grundmuster der explorativen Datenanalyse: Daten einschränken, verdichten und sortieren.</p>
</section><section id="sec-summarize-zusammenfassung" class="level2" data-number="12.7"><h2 data-number="12.7" class="anchored" data-anchor-id="sec-summarize-zusammenfassung">
<span class="header-section-number">12.7</span> Kurz zusammengefasst</h2>
<ul>
<li>
<code>summarise()</code> verdichtet einen Datensatz auf eine einzige Zeile mit Kennzahlen.</li>
<li>
<code>group_by()</code> teilt den Datensatz in Gruppen auf, sodass <code>summarise()</code> eine Zeile pro Gruppe liefert.</li>
<li>
<code>mutate()</code> schreibt Aggregatwerte in jede Zeile, <code>summarise()</code> komprimiert den Datensatz.</li>
<li>
<code>count()</code> ist die Abkürzung für <code>group_by() |&gt; summarise(n = n())</code> und die häufigste Zusammenfassung.</li>
<li>
<code>tally()</code> zählt Zeilen eines bereits gruppierten Datensatzes, <code>add_count()</code> fügt die Zählung als Spalte hinzu.</li>
<li>Mit <code>across()</code> wendet ihr Zusammenfassungen auf mehrere Spalten gleichzeitig an.</li>
<li>Kontrolliert die Gruppierung nach <code>summarise()</code> mit <code>.groups = "drop"</code> oder <code>ungroup()</code>.</li>
</ul>
<p>Mit <code>summarise()</code> könnt ihr eure Daten auf die wesentlichen Kennzahlen verdichten. Im letzten Kapitel dieses Teils lernt ihr, wie ihr mehrere Datensätze über gemeinsame Schlüssel zusammenführt (siehe <a href="joining-data.html" class="quarto-xref"><span>Kapitel 13</span></a>).</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiert");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiert");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../03-data-transformation/filter.html" class="pagination-link" aria-label="Beobachtungen auswählen">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Beobachtungen auswählen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../03-data-transformation/joining-data.html" class="pagination-link" aria-label="Datensätze verbinden">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Datensätze verbinden</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>